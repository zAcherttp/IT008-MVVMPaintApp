<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MVVMPaintApp.Views"
        xmlns:uc="clr-namespace:MVVMPaintApp.UserControls"
        x:Class="MVVMPaintApp.Views.MainCanvasWindow"
        xmlns:conv="clr-namespace:MVVMPaintApp.Converters"
        WindowStartupLocation="CenterScreen"
        mc:Ignorable="d"
        Closing="MainCanvasWindow_Closing"
        PreviewKeyUp="MainCanvasWindow_PreviewKeyUp"
        PreviewKeyDown="MainCanvasWindow_PreviewKeyDown"
        Title="{Binding WindowTitle}" Height="{Binding WindowHeight, Mode=TwoWay}" Width="{Binding WindowWidth, Mode=TwoWay}">
    <Window.Resources>
        <conv:ZoomValueConverter x:Key="ZoomValueConverter"/>
        <DrawingImage x:Key="CursorIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V32 H32 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M32,32z M0,0z M9,4.55266L9,27.153 14.4837,19.6451C15.2369,18.614,16.4369,18.0044,17.7136,18.0044L26.2127,18.0044 9,4.55266z M7,3.4862C7,2.25279,8.4195,1.56026,9.39118,2.31963L28.3824,17.1612C29.574,18.0925,28.9156,20.0049,27.4035,20.0049L17.7136,20.0049C17.0752,20.0049,16.4752,20.3097,16.0987,20.8253L9.87386,29.3478C8.96648,30.5901,7,29.9481,7,28.4096L7,3.4862z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="SelectionIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M24,24z M0,0z M14,3.75A0.75,0.75,0,0,1,13.25,4.5L10.75,4.5A0.75,0.75,0,0,1,10.75,3L13.25,3A0.75,0.75,0,0,1,14,3.75z M4.5,10.75A0.75,0.75,0,0,0,3,10.75L3,13.25A0.75,0.75,0,0,0,4.5,13.25L4.5,10.75z M19.5,10.75A0.75,0.75,0,0,1,21,10.75L21,13.25A0.75,0.75,0,0,1,19.5,13.25L19.5,10.75z M13.25,21A0.75,0.75,0,0,0,13.25,19.5L10.75,19.5A0.75,0.75,0,0,0,10.75,21L13.25,21z M7,3.75A0.75,0.75,0,0,0,6.25,3L5.75,3A2.75,2.75,0,0,0,3,5.75L3,6.25A0.75,0.75,0,0,0,4.5,6.25L4.5,5.75C4.5,5.06,5.06,4.5,5.75,4.5L6.25,4.5A0.75,0.75,0,0,0,7,3.75z M17.75,3A0.75,0.75,0,0,0,17.75,4.5L18.25,4.5C18.94,4.5,19.5,5.06,19.5,5.75L19.5,6.25A0.75,0.75,0,0,0,21,6.25L21,5.75A2.75,2.75,0,0,0,18.25,3L17.75,3z M7,20.25A0.75,0.75,0,0,1,6.25,21L5.75,21A2.75,2.75,0,0,1,3,18.25L3,17.75A0.75,0.75,0,0,1,4.5,17.75L4.5,18.25C4.5,18.94,5.06,19.5,5.75,19.5L6.25,19.5A0.75,0.75,0,0,1,7,20.25z M17.75,21A0.75,0.75,0,0,1,17.75,19.5L18.25,19.5C18.94,19.5,19.5,18.94,19.5,18.25L19.5,17.75A0.75,0.75,0,0,1,21,17.75L21,18.25A2.75,2.75,0,0,1,18.25,21L17.75,21z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="CanvasSizeIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1 M24,24z M0,0z M3,6A3,3,0,0,1,6,3L18,3A3,3,0,0,1,21,6L21,18A3,3,0,0,1,18,21L6,21A3,3,0,0,1,3,18L3,6z M6,5A1,1,0,0,0,5,6L5,18A1,1,0,0,0,6,19L18,19A1,1,0,0,0,19,18L19,6A1,1,0,0,0,18,5L6,5z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="FitToWindowIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M18.25,4A3.75,3.75,0,0,1,22,7.75L22,16.25A3.75,3.75,0,0,1,18.25,20L5.75,20A3.75,3.75,0,0,1,2,16.25L2,7.75A3.75,3.75,0,0,1,5.75,4L18.25,4z M18.25,5.5L5.75,5.5A2.25,2.25,0,0,0,3.5,7.75L3.5,16.25A2.25,2.25,0,0,0,5.75,18.5L18.25,18.5A2.25,2.25,0,0,0,20.5,16.25L20.5,7.75A2.25,2.25,0,0,0,18.25,5.5z M18.25,13A0.75,0.75,0,0,1,19,13.75L19,15A2,2,0,0,1,17,17L15.75,17A0.75,0.75,0,0,1,15.75,15.5L17,15.5A0.5,0.5,0,0,0,17.5,15L17.5,13.75A0.75,0.75,0,0,1,18.25,13z M5.75,13A0.75,0.75,0,0,1,6.5,13.75L6.5,15A0.5,0.5,0,0,0,7,15.5L8.25,15.5A0.75,0.75,0,0,1,8.25,17L7,17A2,2,0,0,1,5,15L5,13.75A0.75,0.75,0,0,1,5.75,13z M7,7L8.25,7A0.75,0.75,0,0,1,8.352,8.493L8.25,8.5 7,8.5A0.5,0.5,0,0,0,6.508,8.91L6.5,9 6.5,10.25A0.75,0.75,0,0,1,5.007,10.352L5,10.25 5,9A2,2,0,0,1,6.85,7.005L7,7z M17,7A2,2,0,0,1,19,9L19,10.25A0.75,0.75,0,0,1,17.5,10.25L17.5,9A0.5,0.5,0,0,0,17,8.5L15.75,8.5A0.75,0.75,0,0,1,15.75,7L17,7z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="NewIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M18.5,20A0.5,0.5,0,0,1,18,20.5L6,20.5A0.5,0.5,0,0,1,5.5,20L5.5,4A0.5,0.5,0,0,1,6,3.5L12,3.5 12,8A2,2,0,0,0,14,10L18.5,10 18.5,20z M13.5,4.621L17.378,8.5 14,8.5A0.5,0.5,0,0,1,13.5,8L13.5,4.621z M19.414,8.414L13.585,2.586C13.559,2.56,13.527,2.54,13.5,2.516A2.072,2.072,0,0,0,13.281,2.336C13.241,2.309 13.195,2.291 13.153,2.268 13.082,2.228 13.012,2.184 12.937,2.152A1.977,1.977,0,0,0,12.313,2.014C12.266,2.011,12.22,2,12.172,2L6,2A2,2,0,0,0,4,4L4,20A2,2,0,0,0,6,22L18,22A2,2,0,0,0,20,20L20,9.828A2,2,0,0,0,19.414,8.414z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="OpenIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M20,9.502L20,8.75A2.25,2.25,0,0,0,17.75,6.5L12.025,6.5 9.645,4.52A2.25,2.25,0,0,0,8.204,4L4.25,4A2.25,2.25,0,0,0,2,6.25L1.996,17.75A2.25,2.25,0,0,0,4.246,20L18.47,20A1.75,1.75,0,0,0,20.168,18.675L21.918,11.677A1.75,1.75,0,0,0,20.22,9.502L20,9.502z M4.25,5.5L8.206,5.5A0.75,0.75,0,0,1,8.686,5.673L11.274,7.827A0.75,0.75,0,0,0,11.754,8L17.75,8A0.75,0.75,0,0,1,18.5,8.75L18.5,9.502 6.424,9.502A2.25,2.25,0,0,0,4.241,11.206L3.497,14.184 3.5,6.25A0.75,0.75,0,0,1,4.25,5.5z M5.697,11.57A0.75,0.75,0,0,1,6.424,11.002L20.22,11.002A0.25,0.25,0,0,1,20.462,11.312L18.712,18.311A0.25,0.25,0,0,1,18.47,18.5L4.285,18.5A0.25,0.25,0,0,1,4.042,18.19L5.697,11.57z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="SaveIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M3,5.75A2.75,2.75,0,0,1,5.75,3L15.714,3A3.25,3.25,0,0,1,18.013,3.952L20.048,5.987C20.658,6.597,21,7.424,21,8.286L21,18.25A2.75,2.75,0,0,1,18.25,21L5.75,21A2.75,2.75,0,0,1,3,18.25L3,5.75z M5.75,4.5C5.06,4.5,4.5,5.06,4.5,5.75L4.5,18.25C4.5,18.94,5.06,19.5,5.75,19.5L6,19.5 6,14.25A2.25,2.25,0,0,1,8.25,12L15.75,12A2.25,2.25,0,0,1,18,14.25L18,19.5 18.25,19.5C18.94,19.5,19.5,18.94,19.5,18.25L19.5,8.286C19.5,7.821,19.316,7.376,18.987,7.048L16.952,5.013A1.75,1.75,0,0,0,16,4.523L16,7.25A2.25,2.25,0,0,1,13.75,9.5L9.25,9.5A2.25,2.25,0,0,1,7,7.25L7,4.5 5.75,4.5z M16.5,19.5L16.5,14.25A0.75,0.75,0,0,0,15.75,13.5L8.25,13.5A0.75,0.75,0,0,0,7.5,14.25L7.5,19.5 16.5,19.5z M8.5,4.5L8.5,7.25C8.5,7.664,8.836,8,9.25,8L13.75,8A0.75,0.75,0,0,0,14.5,7.25L14.5,4.5 8.5,4.5z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="SaveAsIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M5.75,3A2.75,2.75,0,0,0,3,5.75L3,18.25A2.75,2.75,0,0,0,5.75,21L9.999,21A2.112,2.112,0,0,1,10.061,20.407L10.288,19.5 7.5,19.5 7.5,14.25A0.75,0.75,0,0,1,8.25,13.5L14.853,13.5 16.288,12.065A2.258,2.258,0,0,0,15.75,12L8.25,12A2.25,2.25,0,0,0,6,14.25L6,19.5 5.75,19.5C5.06,19.5,4.5,18.94,4.5,18.25L4.5,5.75C4.5,5.06,5.06,4.5,5.75,4.5L7,4.5 7,7.25A2.25,2.25,0,0,0,9.25,9.5L13.75,9.5A2.25,2.25,0,0,0,16,7.25L16,4.523C16.358,4.583,16.692,4.753,16.952,5.013L18.987,7.048C19.316,7.376,19.5,7.821,19.5,8.286L19.5,10.007C19.57,10.002,19.642,10,19.713,10L19.715,10C20.152,10,20.59,10.087,21,10.261L21,8.287A3.25,3.25,0,0,0,20.048,5.988L18.013,3.953A3.25,3.25,0,0,0,15.714,3L5.75,3z M8.5,7.25L8.5,4.5 14.5,4.5 14.5,7.25A0.75,0.75,0,0,1,13.75,8L9.25,8A0.75,0.75,0,0,1,8.5,7.25z" />
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M19.715,11L19.713,11C19.128,11,18.543,11.223,18.098,11.67L12.196,17.572A2.684,2.684,0,0,0,11.489,18.819L11.031,20.65A1.087,1.087,0,0,0,12.35,21.968L14.18,21.511A2.684,2.684,0,0,0,15.428,20.804L21.33,14.902A2.285,2.285,0,0,0,19.715,11z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="RedoIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M19.25,2A0.75,0.75,0,0,0,18.507,2.648L18.5,2.75 18.5,8.44 13.926,3.88A6.41,6.41,0,0,0,5.048,3.701L4.862,3.881A6.41,6.41,0,0,0,4.862,12.944L13.707,21.784A0.75,0.75,0,0,0,14.767,20.722L5.922,11.884A4.91,4.91,0,0,1,12.688,4.772L12.866,4.942 17.438,9.5 11.75,9.5A0.75,0.75,0,0,0,11.007,10.148L11,10.25C11,10.63,11.282,10.944,11.648,10.993L11.75,11 19.25,11A0.75,0.75,0,0,0,19.993,10.352L20,10.25 20,2.75A0.75,0.75,0,0,0,19.25,2z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="UndoIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M4.75,2A0.75,0.75,0,0,1,5.493,2.648L5.5,2.75 5.5,8.44 10.074,3.88A6.41,6.41,0,0,1,18.953,3.701L19.139,3.881A6.41,6.41,0,0,1,19.139,12.944L10.293,21.784A0.75,0.75,0,0,1,9.233,20.722L18.078,11.884A4.91,4.91,0,0,0,11.312,4.772L11.134,4.942 6.562,9.5 12.25,9.5A0.75,0.75,0,0,1,12.993,10.148L13,10.25A0.75,0.75,0,0,1,12.352,10.993L12.25,11 4.75,11A0.75,0.75,0,0,1,4.007,10.352L4,10.25 4,2.75A0.75,0.75,0,0,1,4.75,2z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="ZoomInIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M12.75,9.25A0.75,0.75,0,0,1,12.75,10.75L7.25,10.75A0.75,0.75,0,0,1,7.25,9.25L12.75,9.25z" />
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M17.25,10A7.25,7.25,0,1,0,14.569,15.63L19.469,20.53 19.554,20.603A0.75,0.75,0,0,0,20.53,19.47L15.63,14.569A7.22,7.22,0,0,0,17.25,10z M4.25,10A5.75,5.75,0,1,1,15.75,10A5.75,5.75,0,0,1,4.25,10z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="ZoomOutIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M13.5,10A0.75,0.75,0,0,0,12.75,9.25L10.75,9.25 10.75,7.25A0.75,0.75,0,0,0,9.25,7.25L9.25,9.25 7.25,9.25A0.75,0.75,0,1,0,7.25,10.75L9.25,10.75 9.25,12.75A0.75,0.75,0,0,0,10.75,12.75L10.75,10.75 12.75,10.75A0.75,0.75,0,0,0,13.5,10z" />
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M10,2.75A7.25,7.25,0,0,1,15.63,14.569L20.53,19.469A0.75,0.75,0,0,1,19.554,20.603L19.47,20.53 14.569,15.63A7.25,7.25,0,1,1,10,2.75z M10,4.25A5.75,5.75,0,1,0,10,15.75A5.75,5.75,0,0,0,10,4.25z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="ExitIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M4.397,4.554L4.47,4.47A0.75,0.75,0,0,1,5.446,4.397L5.53,4.47 12,10.939 18.47,4.469A0.75,0.75,0,1,1,19.53,5.53L13.061,12 19.531,18.47A0.75,0.75,0,0,1,19.603,19.446L19.53,19.53A0.75,0.75,0,0,1,18.554,19.603L18.47,19.53 12,13.061 5.53,19.531A0.75,0.75,0,0,1,4.47,18.47L10.939,12 4.469,5.53A0.75,0.75,0,0,1,4.397,4.554L4.47,4.47 4.397,4.554z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="CutIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M24,24z M0,0z M12.1409,9.3415L12.14,9.34286 7.37017,2.3284C7.13725,1.98587 6.67077,1.89702 6.32824,2.12994 5.98572,2.36286 5.89687,2.82934 6.12978,3.17187L11.2606,10.7171 8.86478,14.4605C8.30797,14.1665 7.67342,14.0001 7,14.0001 4.79086,14.0001 3,15.791 3,18.0001 3,20.2093 4.79086,22.0001 7,22.0001 9.20914,22.0001 11,20.2093 11,18.0001 11,17.0089 10.6395,16.1019 10.0424,15.4031L12.178,12.0662 14.2426,15.1024C13.4771,15.831 13,16.8599 13,18.0001 13,20.2093 14.7909,22.0001 17,22.0001 19.2091,22.0001 21,20.2093 21,18.0001 21,15.791 19.2091,14.0001 17,14.0001 16.471,14.0001 15.9659,14.1028 15.5037,14.2894L13.0575,10.692 13.0588,10.69 12.1409,9.3415z M4.5,18.0001C4.5,16.6194 5.61929,15.5001 7,15.5001 8.38071,15.5001 9.5,16.6194 9.5,18.0001 9.5,19.3808 8.38071,20.5001 7,20.5001 5.61929,20.5001 4.5,19.3808 4.5,18.0001z M14.5,18.0001C14.5,16.6194 15.6193,15.5001 17,15.5001 18.3807,15.5001 19.5,16.6194 19.5,18.0001 19.5,19.3808 18.3807,20.5001 17,20.5001 15.6193,20.5001 14.5,19.3808 14.5,18.0001z M13.9381,9.31607L17.8815,3.15438C18.1048,2.8055 18.003,2.34167 17.6541,2.11839 17.3053,1.89511 16.8414,1.99692 16.6181,2.3458L13.0202,7.96756 13.9381,9.31607z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="CopyIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V32 H32 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M32,32z M0,0z M11.75,2C9.95507,2,8.5,3.45508,8.5,5.25L8.5,23.25C8.5,25.0449,9.95507,26.5,11.75,26.5L23.75,26.5C25.5449,26.5,27,25.0449,27,23.25L27,5.25C27,3.45507,25.5449,2,23.75,2L11.75,2z M10.5,5.25C10.5,4.55964,11.0596,4,11.75,4L23.75,4C24.4404,4,25,4.55964,25,5.25L25,23.25C25,23.9404,24.4404,24.5,23.75,24.5L11.75,24.5C11.0596,24.5,10.5,23.9404,10.5,23.25L10.5,5.25z M7,5.74902C5.82552,6.2388,5,7.39797,5,8.74994L5,23.4999C5,27.0898,7.91015,29.9999,11.5,29.9999L20.25,29.9999C21.6021,29.9999,22.7613,29.1743,23.2511,27.9996L20.2786,27.9996C20.2691,27.9998,20.2596,27.9999,20.25,27.9999L11.5,27.9999C9.01472,27.9999,7,25.9852,7,23.4999L7,5.74902z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <DrawingImage x:Key="PasteIcon">
            <DrawingImage.Drawing>
                <DrawingGroup ClipGeometry="M0,0 V32 H32 V0 H0 Z">
                    <GeometryDrawing Brush="{DynamicResource TextFillColorPrimaryBrush}" Geometry="F1 M32,32z M0,0z M7.5,6L9.17071,6C9.58254,7.16519,10.6938,8,12,8L18,8C19.3062,8,20.4175,7.16519,20.8293,6L22.5,6C23.3284,6 24,6.67157 24,7.5 24,8.05228 24.4477,8.5 25,8.5 25.5523,8.5 26,8.05228 26,7.5 26,5.567 24.433,4 22.5,4L20.8293,4C20.4175,2.83481,19.3062,2,18,2L12,2C10.6938,2,9.58254,2.83481,9.17071,4L7.5,4C5.567,4,4,5.567,4,7.5L4,26.5C4,28.433,5.567,30,7.5,30L12,30C12.5523,30 13,29.5523 13,29 13,28.4477 12.5523,28 12,28L7.5,28C6.67157,28,6,27.3284,6,26.5L6,7.5C6,6.67157,6.67157,6,7.5,6z M12,4L18,4C18.5523,4 19,4.44772 19,5 19,5.55228 18.5523,6 18,6L12,6C11.4477,6 11,5.55228 11,5 11,4.44772 11.4477,4 12,4z M17.5,10C15.567,10,14,11.567,14,13.5L14,26.5C14,28.433,15.567,30,17.5,30L25.5,30C27.433,30,29,28.433,29,26.5L29,13.5C29,11.567,27.433,10,25.5,10L17.5,10z M16,13.5C16,12.6716,16.6716,12,17.5,12L25.5,12C26.3284,12,27,12.6716,27,13.5L27,26.5C27,27.3284,26.3284,28,25.5,28L17.5,28C16.6716,28,16,27.3284,16,26.5L16,13.5z" />
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
        <Style x:Key="FitToWindowButtonStyle"
               TargetType="Button"
               BasedOn="{StaticResource DefaultButtonStyle}">
            <Setter Property="Padding" Value="7,1,7,1"/>
            <Setter Property="HorizontalAlignment" Value="Right" />
        </Style>
        <Style x:Key="ZoomComboBoxStyle" 
               TargetType="ComboBox"
               BasedOn="{StaticResource DefaultComboBoxStyle}">
            <Setter Property="Padding" Value="5,4,5,4"/>
        </Style>
    </Window.Resources>

    <Grid ShowGridLines="{Binding ShowGridBorders}">
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="40"/>
        </Grid.RowDefinitions>

        <Menu Grid.Row="0" Panel.ZIndex="10" Background="{DynamicResource CardBackgroundFillColorSecondaryBrush}">
            <MenuItem Header="File">
                <MenuItem Header="New" Command="{Binding NewCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource NewIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Open" Command="{Binding OpenCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource OpenIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Save" Command="{Binding SaveCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource SaveIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Save As">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource SaveAsIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                    <MenuItem Header="PNG" Command="{Binding SaveAsPNGCommand}"/>
                    <MenuItem Header="JPG" Command="{Binding SaveAsJPEGCommand}"/>
                    <MenuItem Header="BMP" Command="{Binding SaveAsBMPCommand}"/>
                </MenuItem>
                <MenuItem Header="Exit" Command="{Binding ExitCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource ExitIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Edit">
                <MenuItem Header="Undo" Command="{Binding UndoCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource UndoIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Redo" Command="{Binding RedoCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource RedoIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Cut" Command="{Binding CutCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource CutIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Copy" Command="{Binding CopyCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource CopyIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Paste" Command="{Binding PasteCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource PasteIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="View">
                <MenuItem Header="Zoom In" Command="{Binding ZoomInCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource ZoomInIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Zoom Out" Command="{Binding ZoomOutCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource ZoomOutIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Fit to Window" Command="{Binding FitToWindowCommand}">
                    <MenuItem.Icon>
                        <Image Source="{StaticResource FitToWindowIcon}" Width="20" Height="20"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <Separator/>
            <MenuItem Command="{Binding SaveCommand}">
                <MenuItem.Icon>
                    <Image Source="{StaticResource SaveIcon}" Width="20" Height="20"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem Command="{Binding UndoCommand}">
                <MenuItem.Icon>
                    <Image Source="{StaticResource UndoIcon}" Width="20" Height="20"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Command="{Binding RedoCommand}">
                <MenuItem.Icon>
                    <Image Source="{StaticResource RedoIcon}" Width="20" Height="20"/>
                </MenuItem.Icon>
            </MenuItem>
        </Menu>
        <StatusBar Grid.Row="2" Panel.ZIndex="10" Padding="4" Background="{DynamicResource CardBackgroundFillColorSecondaryBrush}">
            <StatusBarItem Width="120" HorizontalAlignment="Left" VerticalAlignment="Center">
                <Grid x:Name="CursorInfo">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Image Grid.Column="0" Height="20" Source="{StaticResource CursorIcon}" Stretch="UniformToFill"/>
                    <TextBlock Grid.Column="2" Text="{Binding DrawingCanvasViewModel.MousePosOnCanvas}" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                </Grid>
            </StatusBarItem>
            <Separator Margin="5,2,5,2" BorderThickness="1"/>
            <StatusBarItem Width="120" HorizontalAlignment="Left" VerticalAlignment="Center">
                <Grid x:Name="SelectionInfo">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Image Grid.Column="0" Height="20" Source="{StaticResource SelectionIcon}" Stretch="UniformToFill"/>
                    <TextBlock Grid.Column="2" Text="{Binding DrawingCanvasViewModel.SelectionSize}" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                </Grid>
            </StatusBarItem>
            <Separator Margin="5,2,5,2" BorderThickness="1"/>
            <StatusBarItem Width="120" HorizontalAlignment="Left" VerticalAlignment="Center">
                <Grid x:Name="CanvasSizeInfo">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Image Grid.Column="0" Height="20" Source="{StaticResource CanvasSizeIcon}" Stretch="UniformToFill"/>
                    <TextBlock Grid.Column="2" Text="{Binding DrawingCanvasViewModel.CanvasSize}" Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                </Grid>
            </StatusBarItem>


            <StatusBarItem Width="380" HorizontalAlignment="Right" Height="40" VerticalAlignment="Center">
                <Grid x:Name="ZoomSlider">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="50"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="100"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Button Height="25" Width="40" Style="{StaticResource FitToWindowButtonStyle}" Command="{Binding ProjectManager.FitToWindowCommand}">
                        <Image Source="{StaticResource FitToWindowIcon}" VerticalAlignment="Center" Stretch="Uniform"/>
                    </Button>
                    <ComboBox   IsEditable="True"
                                Style="{StaticResource ZoomComboBoxStyle}" Grid.Column="2" Width="80"
                                ItemsSource="{Binding DrawingCanvasViewModel.ZoomPresets}"
                                Text="{Binding ProjectManager.ZoomFactor.Value, 
                                Converter={StaticResource ZoomValueConverter}, 
                                UpdateSourceTrigger=PropertyChanged}"/>
                    <Image Grid.Column="4" Source="/Resources/ZoomSliderDown.png" Width="20" Height="20" VerticalAlignment="Center" Stretch="UniformToFill"/>
                    <Slider Grid.Column="6" Width="150" Minimum="0.1" Maximum="8.0" Value="{Binding DrawingCanvasViewModel.ProjectManager.ZoomFactor.Value, Mode=TwoWay}"/>
                    <Image Grid.Column="8" Source="/Resources/ZoomSliderUp.png" Width="20" Height="20" VerticalAlignment="Center" Stretch="UniformToFill"/>
                </Grid>
            </StatusBarItem>

        </StatusBar>

        <uc:DrawingCanvas Panel.ZIndex="0" Grid.Row="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
                            DataContext="{Binding DrawingCanvasViewModel}"/>
        <DockPanel Grid.Row="1">
            <uc:LayerControl Panel.ZIndex="10" HorizontalAlignment="Right" Margin="10" Grid.Row="1"
                                DataContext="{Binding LayerViewModel}" DockPanel.Dock="Right" VerticalAlignment="Stretch"/>

            <uc:ColorPaletteControl Panel.ZIndex="10" HorizontalAlignment="Left" Margin="30,0,0,30" VerticalAlignment="Top" Grid.Row="1"
                                DataContext="{Binding ColorPaletteViewModel}" DockPanel.Dock="Bottom"/>

            <uc:ToolboxControl Panel.ZIndex="10" HorizontalAlignment="Left" Margin="30" Grid.Row="1"
                               DataContext="{Binding ToolboxViewModel}" DockPanel.Dock="Left" VerticalAlignment="Center"/>
        </DockPanel>
        <Popup IsOpen="{Binding LayerViewModel.IsColorPickerOpen}"
           PlacementTarget="{Binding ElementName=ZoomSlider}" 
           Placement="Top" HorizontalOffset="-380" VerticalOffset="-13" AllowsTransparency="True"
           PopupAnimation="Fade">
            <Border Background="{DynamicResource CardBackgroundFillColorSecondaryBrush}"
                BorderBrush="{DynamicResource ControlElevationBorderBrush}" BorderThickness="2" 
                CornerRadius="15" Padding="10" Width="610">
                <StackPanel>
                    <uc:ColorPickerControl SelectedColor="{Binding Path=DataContext.LayerViewModel.BackgroundColor, 
                                                RelativeSource={RelativeSource FindAncestor, 
                                                AncestorType={x:Type local:MainCanvasWindow}},
                                                Mode=TwoWay}" Margin="0,0,0,-30" />
                    <Button HorizontalAlignment="Right" Content="Set color" Command="{Binding LayerViewModel.SetBackgroundColorCommand}"/>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</Window>
